---
title: 工作中遇到的js偏门
date: 2018-11-01 00:26:58
tags:
- input
- angular
- javascript
categories: 
- web前端
---

# `input`标签：

`input` 的 `type`属性为`number`的时候,该`input`的`value`值的数据类型是`number`,`js`会使用科学计数法。比如如果用户输入的数值为"100000000",`js`会直接转换`10 * 10 ^ 8` 。`js`则会显示数值为`1e8`

<!-- more -->

## bug：

- `input-type-number`数据类型不匹配的话会无法将数据返回页面。
- 后台在拿前端数据的时候大多数会直接将json字符串的相关字段转换成`string`类型然后再做相应的处理。而且后台语言的科学计数法的计算方式都不一样。后台会报错。
- 后端返回到前端数据时候，由于后台返回的数据都是字符串，但是要将数值放回`input`的`type`是`number`的时候，`value`值的数据类型是`numbe`就会出现无法将数据返回文本框。

## 解决方法：

- 如果要做到判断输入的文字数字不能大于多少位，则可以直接给一个数字跟输入的值坐对比。注意：不要对比字符串的长度。会报错。
- 返回的数据转换成数字类型。`parseInt()`

## js深拷贝和浅拷贝对于引用数据类型的影响

- 由于现在不管是`angular`还是`vue`亦或者其他前端框架，都是双向数据绑定。这时候就会出现浅拷贝数据影响原数据
- 下面举例出使用 `angular`的影响

``` demo
let array = ['fred','name','mike','jack'];
// 这时候在另外一个地方需要用到这个数据，并且不需要第一个‘fred’字符串。可以这么操作
let list = array;
list.splice(0,1);
// 操作完成之后，你会发现变量‘array’中的‘fred’也被删除了
//其实这可以这么处理这个数组。
let newList = array.slice(0);
newList.splice(0,1);
// 这时候如果打印array的话发现“fred”还存在。
```

## 解决方案：进行浅拷贝。将不会影响原数据。

## input标签type=file类型

- 问题：在选择同样的文件的名称的文件的时候上传时，第二次选择完成之后无法触发文件上传。

## 解决方案：在第一次上传完成之后，在回调内手动清除input的value的值。因为file的上传触发是通过value值来触发，如果两次value值一样的话将不会触发onchange事件。